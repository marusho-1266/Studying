問題:

送信元を詐称した電子メールを拒否するために、[[SPF (Sender Policy Framework)]] の仕組みにおいて受信側が行うことはどれか。

**選択肢:**

ア. Resent-Sender:, Resent-From:, Sender:, From: などのメールヘッダーの送信者メールアドレスを基に送信メールアカウントを検証する。

イ. SMTPが利用するポート番号25の通信を拒否する。

ウ. SMTP通信中にやり取りされるMAIL FROMコマンドで与えられた送信ドメインと送信サーバのIPアドレスの適合性を検証する。

エ. 電子メールに付加されたデジタル署名を検証する。

**正解:** ウ

**解説:**

SPF (Sender Policy Framework) は、電子メールの送信元詐称を防ぐための仕組みです。SPFの主な目的は、**受信側が、特定のドメインからメールを送信する権限を持つメールサーバのIPアドレスを検証すること**にあります。

各選択肢の評価は以下の通りです。

- ア. Resent-Sender:, Resent-From:, Sender:, From: などのメールヘッダーの送信者メールアドレスを基に送信メールアカウントを検証する。
    
    これらのヘッダーフィールドは、SPFが直接検証する対象ではありません。SPFは、主にエンベロープFromアドレス（SMTP通信におけるMAIL FROMコマンドで指定されるアドレス）と、そのアドレスのドメインが許可している送信元IPアドレスの整合性を確認します。Fromヘッダーのアドレスは詐称されやすいため、SPFの主要な検証ポイントではありません。
    
- イ. SMTPが利用するポート番号25の通信を拒否する。
    
    ポート25はSMTPの標準ポートであり、このポートの通信を拒否すると、正当なメールの送受信もできなくなります。SPFは、ポート25での通信自体を拒否するのではなく、その通信内容（送信元情報）を検証する仕組みです。
    
- ウ. SMTP通信中にやり取りされるMAIL FROMコマンドで与えられた送信ドメインと送信サーバのIPアドレスの適合性を検証する。
    
    これがSPFの仕組みの中核です。SPFでは、受信側のメールサーバが、SMTPのMAIL FROMコマンドで指定されたドメイン（エンベロープFromアドレスのドメイン）のDNSレコード（TXTレコードまたはSPFレコード）を参照し、そこに記述されている「そのドメインからのメール送信を許可されたIPアドレス」と、実際にメールを送信してきたサーバのIPアドレスが一致するかどうかを検証します。これにより、詐称された送信元からのメールを拒否することが可能になります。
    
- エ. 電子メールに付加されたデジタル署名を検証する。
    
    デジタル署名の検証は、SPFとは異なるメール認証技術である[[DKIM (DomainKeys Identified Mail) ]]や[[S／MIME]]が行う機能です。SPFはデジタル署名ではなく、DNSに登録されたIPアドレス情報に基づいて検証を行います。
    

したがって、SPFにおいて受信側が行うこととして最も適切なのは、「SMTP通信中にやり取りされるMAIL FROMコマンドで与えられた送信ドメインと送信サーバのIPアドレスの適合性を検証する」となります。

---
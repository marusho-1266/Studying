NAT（Network Address Translation：ネットワークアドレス変換）は、**IPアドレスを別のIPアドレスに変換する技術**です。主に、プライベートIPアドレス（LAN内で自由に使えるIPアドレス）とグローバルIPアドレス（インターネット上で一意のアドレス）の間で変換を行うことで、限られたグローバルIPアドレスを有効活用し、同時にセキュリティを向上させる役割を果たします。

**なぜNATが必要なのか？**

- **IPv4アドレスの枯渇問題**: 現在主流のIPv4アドレスは、その数に限りがあり、世界中のすべてのデバイスに一意のグローバルIPアドレスを割り当てるのは困難です。NATを利用することで、一つのグローバルIPアドレスを複数のプライベートIPアドレスを持つデバイスで共有できるため、グローバルIPアドレスの節約に貢献します。
    
- **セキュリティの向上**: 内部ネットワークのデバイスが直接グローバルIPアドレスを持つ必要がなくなり、外部から内部ネットワークの構成が見えにくくなります。これにより、不正アクセスなどに対するセキュリティが向上します。
    

**NATの基本的な仕組み**

ルーターなどのネットワークデバイスがNAT機能を持ち、内部ネットワークから外部（インターネットなど）へパケットが送信される際、送信元のプライベートIPアドレスをグローバルIPアドレスに変換します。逆に、外部から内部へ応答パケットが返ってきた場合、宛先のグローバルIPアドレスを元のプライベートIPアドレスに変換して、適切なデバイスに届けます。

**NATの種類**

NATにはいくつかの種類があります。

1. **静的NAT (Static NAT)**
    
    - プライベートIPアドレスとグローバルIPアドレスを**1対1で固定的にマッピング**します。
        
    - 特定の内部サーバー（Webサーバーなど）を外部に公開する場合によく使われます。外部から常に同じグローバルIPアドレスを指定することで、内部のサーバーにアクセスできます。
        
2. **動的NAT (Dynamic NAT)**
    
    - プライベートIPアドレスとグローバルIPアドレスを**動的にマッピング**します。
        
    - あらかじめ登録された複数のグローバルIPアドレスのプールから、空いているものを動的に割り当てて変換します。グローバルIPアドレスの数が限られている場合に、複数の内部デバイスがインターネットにアクセスできるようになります。
        
3. **[[NAPT（Network Address Port Translation）]] / IPマスカレード**
    
    - 最も一般的に家庭や企業で利用されているNATの種類です。
        
    - IPアドレスの変換に加えて、**ポート番号の変換も行います**。これにより、**たった一つのグローバルIPアドレスを、複数のプライベートIPアドレスを持つデバイスが共有してインターネットにアクセスできます。**
        
    - 例えば、家庭内の複数のPCやスマートフォンが、ルーターに割り当てられた一つのグローバルIPアドレスを使って同時にインターネットに接続できるのは、このNAPTの機能によるものです。
        
    - 通信を識別するために、送信元/宛先のIPアドレスだけでなく、ポート番号も変換テーブルに記録し、双方向の通信を正しくルーティングします。
        

**NATのメリット**

- **IPv4アドレスの節約**: 限られたグローバルIPアドレスを有効活用できます。
    
- **セキュリティ向上**: 内部ネットワークの構成が外部から隠蔽されるため、直接的な攻撃を受けにくくなります。
    
- **柔軟なネットワーク設計**: 内部ネットワークのIPアドレス設計が容易になり、新しいデバイスの追加も比較的簡単です。
    

**NATのデメリット**

- **通信遅延**: パケットがルーターを通過する際にIPアドレスやポート番号の変換処理が行われるため、微小な遅延が発生する可能性があります。
    
- **一部アプリケーションの不具合**: IPアドレスやポート番号が途中で変わるため、FTPのアクティブモードや一部のP2P通信、ビデオ通話、VPNなど、IPアドレスを直接参照するアプリケーションで問題が発生する場合があります。これは、ポートフォワーディング（ポート開放）やUPnPなどの設定で解決できる場合もあります。
    
- **通信の追跡困難化**: IPアドレスが変換されるため、通信ログなどを確認する際に、元のIPアドレスを特定するのが難しくなる場合があります。トラブルシューティングやセキュリティインシデントの調査を複雑にする可能性があります。
    
- **外部からの直接接続の難しさ**: NATの性質上、外部から内部の特定のデバイスに直接接続するのが難しくなります。サーバーを公開する場合などは、静的NATやポートフォワーディングの設定が必要です。
    

NATは現代のインターネット環境において不可欠な技術であり、私たちの日常生活でも広く利用されています。
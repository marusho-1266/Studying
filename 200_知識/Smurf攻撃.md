Smurf攻撃は、[[分散型サービス拒否（DDoS）攻撃]]の一種で、主に[[ICMP（Internet Control Message Protocol）]]**プロトコルの脆弱性と**[[IPブロードキャストアドレス]]**を悪用して、標的のシステムやネットワークを過負荷にさせる技術です。

その仕組みは、以下のステップで構成されます。

1. **攻撃者の準備:**
    
    - 攻撃者は、攻撃対象のIPアドレスを特定します。
        
    - ブロードキャスト機能を有効にしている「Smurfアンプ」と呼ばれるネットワーク（通常は大規模なネットワーク）を見つけます。このネットワークは、攻撃者の意図しない形で攻撃の「増幅器」として利用されます。
        
2. **IPアドレスの詐称（Spoofing）:**
    
    - 攻撃者は、送信元IPアドレスを**攻撃対象のIPアドレスに詐称した（偽装した）ICMPエコー要求パケット（Ping）**を作成します。
        
3. **ブロードキャストアドレスへの送信:**
    
    - 作成したICMPエコー要求パケットを、見つけた「Smurfアンプ」ネットワークの**ブロードキャストアドレス**（例: 192.168.1.255）に送信します。
        
4. **増幅（Amplification）:**
    
    - ブロードキャストアドレス宛のパケットを受信した「Smurfアンプ」ネットワーク内のすべてのデバイス（ホスト）は、そのパケットが「攻撃対象」からの要求であると認識します。
        
    - 各デバイスは、詐称された送信元IPアドレス（つまり攻撃対象のIPアドレス）に対して、**ICMPエコー応答パケット**を返信します。
        
5. **標的への集中:**
    
    - 結果として、「Smurfアンプ」ネットワーク内の多数のデバイスから、大量のICMPエコー応答パケットが**攻撃対象のシステムに一斉に集中**します。
        
6. **サービス拒否（Denial of Service - DoS）:**
    
    - 攻撃対象のシステムやネットワークは、この大量のトラフィックによって帯域幅が飽和したり、リソースが枯渇したりして、正当な通信を処理できなくなり、サービス停止（DoS状態）に陥ります。
        

**Smurf攻撃の主な特徴:**

- **増幅（Amplification）効果:** 攻撃者が送信するパケットは少量でも、ブロードキャストネットワーク内の多数のホストからの応答によって、攻撃対象に到達するトラフィックが何十倍、何百倍にも増幅されます。これがSmurf攻撃の最も危険な点です。
    
- **IPアドレス詐称（Spoofing）:** 攻撃者の実際のIPアドレスが隠蔽されるため、攻撃元を特定するのが困難になります。
    
- **ICMPプロトコルの悪用:** ネットワーク診断によく使われるICMPプロトコルの特性を悪用しています。
    

近年では、ルーターやファイアウォールの設定によってIPブロードキャストへの応答を制限したり、送信元IPアドレス詐称されたパケットをフィルタリングする対策が広く導入されたため、以前ほど頻繁には見られなくなっています。しかし、その原理はDDoS攻撃における「増幅」の概念を理解する上で重要です。


## 歴史
Smurf攻撃は、インターネットの黎明期から普及期にかけて、ネットワークの基本的なプロトコル設計やデフォルト設定の甘さが露呈した代表的なDDoS攻撃の一つです。その発生原因と歴史的流れは以下のようになります。

### 1. 発生原因となった技術的要素

Smurf攻撃が成り立った背景には、以下の技術的要素が組み合わさったことが挙げられます。

- **IPブロードキャストの特性:**
    
    - IPブロードキャストアドレスは、特定のサブネット内の全てのホストに同時にパケットを送信するための便利な機能として設計されました。これは、DHCP (IPアドレス自動割り当て) や ARP (IPアドレスからMACアドレスへの変換) など、ネットワーク初期設定や検出に不可欠な機能でした。
        
    - しかし、ルーターがブロードキャストパケットを他のネットワークセグメントに転送する機能（「Directed Broadcast」または「Smurfアンプ」機能）がデフォルトで有効になっている場合がありました。
        
- **ICMPエコー要求/応答の特性:**
    
    - `ping` コマンドなどで使われるICMPエコー要求/応答は、ネットワークの疎通確認や診断に非常に便利なツールです。
        
    - このプロトコルは、要求が来たら必ず応答を返すという単純な設計でした。
        
- **IPアドレス詐称（IP Spoofing）の容易さ:**
    
    - 初期のインターネットでは、送信元IPアドレスの正当性を検証する仕組みが十分に確立されていませんでした。そのため、攻撃者は比較的容易に送信元IPアドレスを偽装（詐称）してパケットを送信することができました。
        

これらの要素が組み合わさることで、攻撃者がわずかなパケットを送信するだけで、膨大な量の応答パケットを標的に集中させることが可能になりました。

### 2. 歴史的流れと対策

- **1990年代中盤：攻撃の出現と認識**
    
    - Smurf攻撃の概念は、1990年代中盤にセキュリティ研究者によって認識され始めました。特に1997年に"Smurf Attack"という名前で詳細が公表され、その危険性が広く知られるようになりました。
        
    - この頃は、インターネットが急速に普及し始めた時期であり、多くのネットワーク機器やサーバーのデフォルト設定がセキュリティよりも利便性や機能性を優先していました。特に、ルーターのブロードキャスト転送機能がデフォルトで有効なケースが多かったため、簡単に「Smurfアンプ」になり得ました。
        
- **1990年代後半～2000年代初頭：DDoS攻撃の主要な手法の一つに**
    
    - Smurf攻撃は、[[Ping of Death]]や[[SYN Flood攻撃]]と並んで、当時の代表的なDDoS攻撃の手法として頻繁に利用されました。
        
    - 特にその「増幅（Amplification）」効果の高さから、攻撃者が少ないリソースで大きな被害を与えることができるため、多くのDDoS攻撃で悪用されました。
        
- **2000年代以降：対策の普及と攻撃の減少**
    
    - Smurf攻撃の深刻な被害が認識されるにつれて、業界全体で対策が講じられるようになりました。
        
        - **ルーターのデフォルト設定変更:** 多くのルーターベンダーは、ブロードキャストアドレスへのIPパケット転送（Directed Broadcast）をデフォルトで無効にするようになりました。これにより、ネットワークがSmurfアンプとして悪用される可能性が大幅に減少しました。
            
        - **エグレスフィルタリング（Egress Filtering）の推奨:** ISP（インターネットサービスプロバイダ）や企業ネットワークの出口ルーターで、送信元IPアドレスがそのネットワークに割り当てられたものでないパケットを破棄する「エグレスフィルタリング」が広く推奨され、導入が進みました。これにより、攻撃者が送信元IPアドレスを詐称したパケットをインターネットに流すことが困難になりました。
            
        - **ICMPフィルタリング:** ファイアウォールで、外部からの不必要なICMPエコー要求やブロードキャストへの応答を制限する設定が一般化しました。
            
    - これらの対策が普及した結果、Smurf攻撃は以前ほど効果的な攻撃手法ではなくなり、その発生頻度も大幅に減少しました。現在では、より巧妙なDDoS攻撃（DNS増幅攻撃、NTP増幅攻撃など、他のプロトコルを悪用した増幅攻撃）が主流となっています。
        

### まとめ

Smurf攻撃は、IPブロードキャスト、ICMP、IPアドレス詐称というインターネットの基本的な技術要素が組み合わされることで発生したDDoS攻撃です。その歴史は、ネットワーク設計におけるセキュリティの重要性を再認識させ、DDoS対策技術の発展を促すきっかけとなりました。現在では直接的なSmurf攻撃の被害は稀ですが、その原理である「増幅」と「IPアドレス詐称」は、今日の多くのDDoS攻撃にも通じる重要な概念であり続けています。
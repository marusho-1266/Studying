### S/MIME (Secure/Multipurpose Internet Mail Extensions) とは

S/MIME (Secure/Multipurpose Internet Mail Extensions) は、電子メールの**セキュリティ機能（暗号化とデジタル署名）** を提供するための標準規格です。一般的な電子メール（MIME形式）に、暗号化とデジタル署名の機能を追加することで、メールの**機密性**と**完全性・認証性**を確保することを目的としています。

#### S/MIMEの目的

- **機密性の確保（暗号化）:** メールの内容が盗聴されることを防ぎます。S/MIMEで暗号化されたメールは、正当な受信者（復号するための秘密鍵を持つ者）だけが内容を読めるようになります。
    
- **完全性の確保（デジタル署名）:** メールの送信中に内容が改ざんされていないことを保証します。受信者は、メールが送信されてから自分に届くまでの間に、本文や添付ファイルが変更されていないことを確認できます。
    
- **認証性の確保（デジタル署名）:** メールの送信元が本当にその人であるかを確認します。これにより、送信元詐称を防ぎ、メールの信頼性を高めます。
    
- **否認防止（デジタル署名）:** 一度送信したメールの送信者が、「自分は送っていない」と後から否認することを防ぎます。
    

#### S/MIMEの仕組み

S/MIMEは、公開鍵暗号方式と共通鍵暗号方式を組み合わせたハイブリッド暗号方式、およびデジタル署名を利用します。これらの機能を利用するには、信頼された認証局 (CA: Certificate Authority) から発行された**デジタル証明書**が必要です。

**1. デジタル署名（認証性、完全性、否認防止）**

- **送信側:**
    
    1. 送信者は、自分の**デジタル証明書**（公開鍵と身元情報が含まれる）と、それに対応する**秘密鍵**を所持しています。
        
    2. 送信するメールの本文や添付ファイルをハッシュ関数で要約します（メッセージダイジェストを作成）。
        
    3. このメッセージダイジェストを、自分の**秘密鍵**で暗号化し、**デジタル署名**を生成します。
        
    4. 生成されたデジタル署名と、送信者の**デジタル証明書**をメールに添付して送信します。
        
- **受信側:**
    
    1. 受信者は、添付された送信者の**デジタル証明書**から**公開鍵**を取得し、その公開鍵でデジタル署名を復号します。これにより、送信者が秘密鍵で署名したメッセージダイジェストが得られます。
        
    2. 同時に、受信したメールの本文や添付ファイルを同じハッシュ関数で要約します。
        
    3. 両方のメッセージダイジェスト（復号したものと、自分で算出したもの）を比較します。
        
    4. **比較結果:**
        
        - 一致すれば、メールが改ざんされておらず、秘密鍵の所有者（デジタル証明書の正当な所有者）が送信したことが確認できます。
            
        - 不一致であれば、メールが改ざんされたか、署名が不正であると判断されます。
            
    5. さらに、送信者のデジタル証明書が信頼できる認証局によって発行されたものであるか、失効していないかなども検証します。
        

**2. 暗号化（機密性）**

- **送信側:**
    
    1. 送信者は、受信者の**デジタル証明書**（受信者の公開鍵が含まれる）を事前に知っている必要があります。これは、受信者から直接受け取るか、公開されているディレクトリサービスから取得します。
        
    2. メールの本文と添付ファイルを、一時的に生成される**共通鍵**で暗号化します。
        
    3. この共通鍵を、受信者の**公開鍵**で暗号化します。
        
    4. 暗号化されたメールの内容と、暗号化された共通鍵をメールに添付して送信します。
        
- **受信側:**
    
    1. 受信者は、暗号化された共通鍵を、自分の**秘密鍵**で復号します。これにより、メールの暗号化に使われた共通鍵が得られます。
        
    2. この共通鍵を使って、暗号化されたメールの内容（本文や添付ファイル）を復号し、元のメールを閲覧します。
        

#### S/MIMEの特長とメリット・デメリット

**メリット:**

- **高いセキュリティレベル:** デジタル証明書と公開鍵暗号方式に基づいているため、高い機密性と認証性を実現します。
    
- **個別のメール保護:** メール単位で暗号化・署名を行うため、個々の通信の安全性を確保できます。
    
- **法的証拠能力:** デジタル署名は非改ざん性と送信者の特定に役立ち、電子的な証拠としての価値を持ち得ます。
    

**デメリット:**

- **証明書の取得と管理:** 利用には信頼できる認証局からのデジタル証明書の取得が必要であり、費用や手続き、有効期限の管理が必要です。
    
- **ソフトウェアの対応:** S/MIMEに対応したメールクライアント（Outlook, Thunderbird, Apple Mailなど）が必要であり、設定も必要になります。
    
- **公開鍵の共有:** 暗号化には受信者の公開鍵が必要なため、事前に公開鍵を共有する仕組みや手間が発生します。特に初めてやり取りする相手との暗号化には課題があります。
    
- **使い勝手:** 受信側も証明書と対応クライアントが必要なため、不特定多数へのメールには不向きで、主に組織内や特定の関係者間での利用が一般的です。
    

#### SPF, DKIM, S/MIME の比較

|技術名|目的|対象とする問題|検証方法|導入の主体|主な利用シーン|
|---|---|---|---|---|---|
|**SPF**|送信元ドメインのなりすまし防止|エンベロープFromの詐称|DNSのIPアドレスリスト|送信ドメイン管理者|スパム・フィッシング対策|
|**DKIM**|送信元ドメインの認証、メールの改ざん検知|Fromヘッダーの詐称、内容改ざん|デジタル署名（DNS公開鍵）|送信ドメイン管理者|スパム・フィッシング対策、ブランド保護|
|**S/MIME**|メール全体の暗号化、デジタル署名|盗聴、改ざん、送信元詐称、否認防止|デジタル証明書と鍵ペア|個々のユーザー・組織|機密情報のやり取り、法的証拠|

Google スプレッドシートにエクスポート

S/MIMEは、SPFやDKIMがサーバー間の認証を主眼とするのに対し、**エンドツーエンドのメールセキュリティ**（送信者と受信者間の直接的なセキュリティ）を提供する点で異なります。特に、機密性の高い情報をメールでやり取りする際に、その内容を保護するために利用されます。
ダイナミックパケットフィルタリングとは、ファイアウォールなどのセキュリティデバイスが、**通信の状態（セッション）を監視し、その状態に基づいてパケットの通過を動的に制御する技術**です。

より具体的に言うと、以下のような特徴があります。

- **状態の維持（ステートフル）**: 過去の通信記録（セッション情報）を記憶し、現在進行中の通信が正当なものかどうかを判断します。これにより、単にパケットの送信元IPアドレスやポート番号を見るだけでなく、通信の「文脈」を理解した上でフィルタリングを行います。このため、「ステートフルインスペクション」とも呼ばれます。
    
- **動的なポートの開閉**: 内部ネットワークから外部へ通信を開始した場合、その応答として外部から内部への通信が必要になります。ダイナミックパケットフィルタリングは、この応答パケットを識別し、一時的に必要なポートを開放します。通信が終了すると、そのポートは自動的に閉じられます。
    
- **双方向の通信制御**: 内部から外部への通信だけでなく、その応答としての外部から内部への通信も許可することで、安全かつスムーズな通信を実現します。
    

**仕組みの例（Webブラウジングの場合）**

1. **内部からの通信開始**: 社内PCからWebサーバー（外部）へWebページを見に行くためのパケット（例えばTCPの[[SYNパケット]]）が送信されます。
    
2. **ファイアウォールによる検知とルール追加**: ファイアウォールは、この内部からの通信を検知し、「このPCからこのWebサーバーへの通信が開始された」というセッション情報を記憶します。そして、この通信の応答としてWebサーバーから返ってくるパケットを通過させるための一時的なルールを動的に追加します。
    
3. **応答パケットの通過**: Webサーバーからの応答パケット（SYN+ACKなど）が届くと、ファイアウォールはこのセッション情報と照合し、正当な応答であると判断して通過させます。
    
4. **通信終了時のルール削除**: 通信が終了すると、ファイアウォールは追加した一時的なルールを削除し、ポートを閉じます。
    

**メリット**

- **セキュリティの向上**: 必要なときだけポートを開放し、通信終了後は閉じるため、常にポートを開放している静的なパケットフィルタリングに比べて、不正アクセスや攻撃される隙を大幅に減らすことができます。特に、偽装されたパケットや不正な手順で送られてくるパケットを見抜いて遮断する能力が高いです。
    
- **柔軟な通信制御**: アプリケーションによっては、通信中に動的にポート番号が変わるものがありますが、ダイナミックパケットフィルタリングはこのような通信にも対応できます。
    
- **管理の簡素化**: 事前にすべてのポートを開放する設定をしなくても、必要な通信を動的に許可するため、ファイアウォールの設定が簡素化される場合があります。
    

**利用例**

主にファイアウォール機能として利用され、企業ネットワークの境界やクラウド環境の境界防御など、外部からの不正アクセスを防ぐために広く用いられています。
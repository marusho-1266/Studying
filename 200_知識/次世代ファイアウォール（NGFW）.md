次世代ファイアウォール（NGFW：Next-Generation Firewall）とは、**従来のファイアウォールが持つ基本的な機能に加え、より高度な脅威対策とアプリケーションレベルでの詳細な制御を可能にしたセキュリティデバイス**です。

従来のファイアウォールが主に「IPアドレス」と「ポート番号」に基づいて通信を許可・拒否するのに対し、NGFWは、今日の複雑で巧妙なサイバー攻撃に対応するため、以下のような「次世代」の機能を提供します。

### NGFWの主な機能

1. **アプリケーションの認識と制御（Application Awareness and Control）**:
    
    - 従来のファイアウォールは、HTTP（80番ポート）やHTTPS（443番ポート）といった「ポート番号」でWeb通信を識別していましたが、NGFWはポート番号だけでなく、その通信が具体的にどのアプリケーション（例：Facebook、YouTube、Salesforce、Skypeなど）を使用しているかを識別できます。
        
    - これにより、「特定の部署ではSNSの利用を制限するが、業務で必要なSalesforceは許可する」といった、よりきめ細やかなアプリケーション単位でのアクセス制御が可能になります。
        
2. **侵入防止システム（IPS：Intrusion Prevention System）の統合**:
    
    - ネットワークトラフィックをリアルタイムで監視し、既知の攻撃パターン（シグネチャ）や異常な振る舞いを検出し、不正な通信を自動的にブロックします。
        
    - 従来のファイアウォールは、パケットがポリシーに合致するかどうかを検査するのに対し、IPSはパケットの内容（ペイロード）まで深く検査し、攻撃コードの有無などを判断します。
        
3. **SSL/TLSインスペクション（暗号化通信の可視化）**:
    
    - 現代の通信の多くはHTTPSなどで暗号化されていますが、これによりマルウェアや機密情報漏洩が暗号化通信の中に隠されるリスクがあります。
        
    - NGFWは、SSL/TLS通信を一時的に復号し、その中身を検査（ディープパケットインスペクション：DPI）することで、暗号化された脅威やポリシー違反を検出・防御します。検査後に再び暗号化して通信を継続します。
        
4. **ユーザーIDの識別と制御**:
    
    - 単にIPアドレスだけでなく、通信を行っている「ユーザー」のID（Active Directoryなどの認証システムと連携）を識別し、ユーザーやグループ単位でアクセス制御やセキュリティポリシーを適用できます。
        
    - これにより、「営業部の田中さんには〇〇サービスを許可するが、開発部の鈴木さんにはアクセスを制限する」といった、よりパーソナライズされたセキュリティ対策が可能になります。
        
5. **脅威インテリジェンスとの連携**:
    
    - 最新の脅威情報（マルウェアのハッシュ値、C2サーバーのIPアドレス、フィッシングサイトのURLなど）を外部の脅威インテリジェンスフィードから取り込み、リアルタイムで防御に役立てます。これにより、未知の脅威や進化する攻撃にも迅速に対応できます。
        
6. **サンドボックス機能との連携**:
    
    - 不審なファイルやコードを隔離された仮想環境（サンドボックス）で実行し、その挙動を分析することで、未知のマルウェア（ゼロデイ攻撃）を検出・防御します。
        
7. **統一脅威管理（UTM）機能の統合**:
    
    - NGFWは、ファイアウォール、IPS、アンチウイルス、Webフィルタリング、スパム対策など、複数のセキュリティ機能を一つのデバイスに統合し、管理を簡素化する傾向があります。UTMはより広範なセキュリティ機能を指しますが、NGFWはその中核をなすものと考えることもできます。
        

### 従来のファイアウォールとの違い

|特徴|従来のファイアウォール（ステートフルファイアウォール）|次世代ファイアウォール（NGFW）|
|---|---|---|
|**検査レベル**|OSI参照モデルのレイヤー3（IPアドレス）、レイヤー4（ポート番号）|OSI参照モデルのレイヤー7（アプリケーション層）まで深く検査（ディープパケットインスペクション）|
|**制御粒度**|IPアドレスとポート番号ベース|アプリケーション、ユーザー、コンテンツ、脅威タイプベース|
|**脅威検知**|静的なルール、既知のプロトコル違反の検知|既知・未知のマルウェア、不正侵入、データ漏洩、暗号化された脅威などを検出。脅威インテリジェンス、サンドボックス連携も可能。|
|**暗号化通信**|検査不可（トンネルを素通り）|SSL/TLSインスペクションにより復号・検査可能|
|**管理**|比較的シンプル|多機能ゆえに複雑になるが、統合管理コンソールで効率化。ログやレポート機能も充実。|
|**目的**|ネットワーク境界のアクセス制御|ネットワーク境界での多角的な脅威防御、アプリケーション・ユーザー単位での詳細なポリシー適用、情報漏洩対策、コンプライアンス対応など、より高度で統合的なセキュリティ対策|

### まとめ

NGFWは、今日の高度化・多様化するサイバー攻撃から組織のネットワークと情報を守るために不可欠なセキュリティ技術です。従来のファイアウォールでは見逃されがちなアプリケーション層の脅威や暗号化された通信内の脅威にも対応することで、より堅牢なセキュリティ環境を構築することを目的としています。